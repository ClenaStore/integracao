<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
<title>Painel de ImportaÃ§Ãµes</title>
<style>
:root{
  --bg:#f8fafc;--card:#fff;--border:#e5e7eb;
  --text:#111827;--muted:#6b7280;--accent:#0284c7;
}
body{margin:0;background:var(--bg);font-family:Inter,system-ui,sans-serif;color:var(--text);}
h1{text-align:center;padding:10px 0;color:var(--accent);}
table{width:95%;margin:auto;border-collapse:collapse;}
th,td{padding:8px;border-bottom:1px solid var(--border);}
th{background:#e2e8f0;text-align:left;}
button{padding:6px 10px;border:none;border-radius:6px;cursor:pointer;}
.exec{background:#16a34a;color:#fff;}
.off{background:#f3f4f6;color:#6b7280;}
.status{font-size:13px;}
</style>
</head>
<body>
<h1>ðŸ•’ Painel de ImportaÃ§Ãµes</h1>
<table id="tbl"><tr><th>Empresa</th><th>HorÃ¡rio</th><th>Ãšltima</th><th>Status</th><th>AÃ§Ãµes</th></tr></table>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbx3aAo12AiQSE35S4Bj1SDtUu6sBWs71b5T1dwuK6NxMn0aDJbk_df4r7pahhNc4_KN/exec";
async function carregar(){
  const r=await fetch(API_URL);
  const d=await r.json();
  const tbl=document.querySelector("#tbl");
  d.empresas.forEach(e=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`
      <td>${e.empresa}</td>
      <td>${e.horario}</td>
      <td>${e.ultima||"-"}</td>
      <td class="status">${e.status||"-"}</td>
      <td><button class="exec" onclick="executar('${e.empresa}')">Executar Agora</button></td>`;
    tbl.appendChild(tr);
  });
}
async function executar(empresa){
  const btn=event.target;btn.textContent="Executando...";
  await fetch(API_URL,{method:"POST",headers:{"Content-Type":"application/json"},
    body:JSON.stringify({action:"executar",empresa})});
  btn.textContent="âœ… Feito";
  setTimeout(()=>location.reload(),1500);
}
carregar();
</script>
</body>
</html>
